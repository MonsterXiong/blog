---
sidebar: auto
---

# 互联网

思考：数据是如何从一个设备传递到另一个设备的？

- 这一切都是由网络协议来规定的。没有网络协议，就没有今天的互联网

互联网、移动互联网、物联网、音视频、直播都离不开网络协议，最熟悉的网络协议可能是 HTTP，为了满足各种需要，有各式各样的网络协议（HTTPS、SMTP、MQTT、RTMP），例如：文件操作 FTP 协议

## C\C++的跨平台原理

C\C++的跨平台：代码（`.c\.cpp`[c-plus-plus]文件）使用平台相关的编译器生成对应平台的可执行文件。也就是说 C\C++编译之后可以直接生成平台对应的可执行文件。所以 C/C++的跨平台需要编译多次。

> 编译 Mach-O（010101）运行 Mac
>
> 编译 PE（p extable 可执行 01010）格式运行 Windows
>
> 编译 ELF 格式运行 Linux

> 一个代码可以跑多个系统或平台，我们就说它是跨平台的

> 可执行文件就是可以直接跑到操作系统上，操作系统直接识别这个文件，加载这个文件，直接搞进内存，读取里面的机器指令来执行的（PE、Mach-O、ELF 格式就是可执行文件）

## Java 的跨平台原理

`*.java`编译`*.class`（字节码文件）

字节码文件（还不是由 01 组成的机器码）对操作系统来说，不是可执行文件。而 JAVA 需要在操作系统下载并启动 JVM（Java 虚拟机），JVM 就可以加载字节码文件，然后就会解析字节码内容，然后就会翻译为机器指令。

Java 的跨平台：一次编译，到处运行（利用的 JVM）

首先编译生成跟平台无关的字节码文件（class 文件），然后由对应平台的 JVM 解析字节码为机器指令。如果代码有语法错误，将编译失败，并不会生成字节码文件，那就不会去运行一个 JVM 程序，最后导致 Java 程序运行失败。

Java 也是一种解释型语言

## 什么是协议

（例如租房协议，协议是用来约束双方的，节省沟通成本）

如果租房协议有一个国家（或国际）标准，会是怎样？

如果有标准意味着都一样，减少沟通成本，都不需要阅读协议了

##　网络协议

用来规定客服端和服务器能干什么，客户端能发什么，服务器能返回什么，有很多客户端和服务器，如果每个公司都有自己的网络协议，那都要按照公司的网络协议去请求，不利于互联网发展，国际标准化组织 ISO，制定标准，HTTP

## 网络互连模型

为了更好地促进互联网络的研究和发展，国际标准化组织 ISO 在 1985 年指定了网络互连模型。（在 1985 年之前就有互联网了，在那之前十分混乱）

OSI 参考模型（Open System interconnect Reference Model）,具有 7 层结构

指定标准的组织不一定有实战经验，他们有理论。

（应用层、表示层、会话层、运输层、网络层、数据链路层、物理层）

> 参考模型

应用层、传输层、网络层、网络接口层

> TCP/IP 协议属于实战型

应用层、运输层、网络层、数据链路层、物理层

> 学习研究

请求过程

所有网络协议都会这样一层一层的输出

不管是 HTTP，FTP 还是各种各样的其他网络协议都遵守这个过程

## 网络的一些基本概念

##　计算机之间的通信基础
通信：你发些东西给我，我发些东西给你

首先需要知道对方的 IP 地址，有了 IP 地址还不够，还需要知道 MAC 地址（网卡地址），那是因为自动解析了 MAC 地址。

1. 需要知道对方的 IP 地址
2. 最终是根据 MAC 地址，输送数据到网卡，被网卡接收
   - 如果网卡发现数据的目标 MAC 地址是自己，就会将数据传递给上一层进行处理
   - 如果网卡发现数据的目标 MAC 地址不是自己，就会将数据丢弃，不会传递给上一层进行处理

## 计算机之间的连接方式

###　网线直连

两台设备想通信，最简单的方式就是通过网线（橙白橙，水晶头）。

我们可以使用**Packer Tracer**模拟工具。

> 使用模拟工具简单的模拟两台计算机通信的时候，不在同一个网段是 ping 不通的，需要路由器，因为路由器可以连接两个不同的网段

仿真 PDU 发包等价于 ping,用的 ICMP 协议

ARP 协议广播，广播是在同一个网段中传播的，发广播的目的就是获取对方的 MAC 地址。只有通过 ARP 协议拿到 MAC 地址才能进行 ICMP 协议，

> arp -a 是可以看到计算机的 MAC 地址的缓存的

> MAC 地址是 FFF.FFF.FFF.FFF,全 1，代表是广播，在同一个网段的所有网卡都会接收到广播。

### 同轴电缆(Coaxial)

网线直连无法连接多台设备，不能实现互联。

早期的实现互联是用同轴电缆，同轴电缆左右两边有两个终结电阻，通过 T 型连接器（T 型头）连接计算机从而进行互联。

- 半双工通信（同一时间只能允许一个方向进行发数据）
- 容易冲突
- 不安全
- 中间断了，整个都会瘫了

同轴电缆就是半双工通信，同轴电缆一发送就会到处发送，然后计算机发现 MAC 地址不是自己的，就会直接丢掉，左右两边的电阻就是终止信号。

### 集线器(Hub)

我们发现同轴电缆有一个问题就是说，一个地方除了问题，就会整个都瘫了。所以出现了集线器（相当于同轴电缆升级版）。集线器能保证互传，但是集线器也不会缓存 MAC 地址。而且集线器连接的设备越多，效率越低。

- 半双工通信
- 容易冲突
- 不安全

> 相同设备用的是交叉线，不同设备用的是直通线

> 在终端 arp -a 可以看到当前这台设备缓存的 MAC 地址

### 网桥(Bridge)

网桥只有两个接口，还是连接同一网段（左右两边都是一个冲突域），它记录着一张接口 MAC 地址表

它的好处有：

- 能够通过自学习得知每个接口那侧的 MAC 地址
- 从而起到隔绝冲突鱼的作用（同个冲突域内部就可以同时通信了）

### 交换机(Switch)

网桥只有两个接口，交换机相当于拥有集线器+网桥功能，直接连接计算机，学习完之后就可以很精准的转发了，它是局域网的终极方案。

- 相当于接口更多的网桥（带有集线器转发要求的功能）
- 全双工通信
- 比集线器安全

> 二层交换机没有 IP 地址，三层交换机有 IP 地址

但是如果全球所有的设备都用交换机连接会是什么情况呢？

发广播的时候，全球计算机都会收到，只是要不要把包丢掉的问题，因为都是同一网段，所以可以广播，刚开始不知道 MAC 地址，因此还需要广播

### 路由器(Router)

路由器的作用就是可以在不同的网段之间发送数据，隔绝广播域

网线直连、同轴电缆、集线器、网桥、交换机

- 连接的设备必须在同一网段
- 连接的设备处在同一广播域
