(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{483:function(t,s,n){"use strict";n.r(s);var a=n(26),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"ajax"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ajax"}},[t._v("#")]),t._v(" Ajax")]),t._v(" "),n("h2",{attrs:{id:"ajax-简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ajax-简介"}},[t._v("#")]),t._v(" Ajax 简介")]),t._v(" "),n("p",[t._v("首先：传统的网页（不使用 AJAX）如果需要更新内容，必须重载整个网页")]),t._v(" "),n("p",[t._v("AJAX 全称为 Asynchronous JavaScript And XML,即异步的 JS 和 XML。")]),t._v(" "),n("p",[t._v("通过 AJAX 可以在不重新刷新页面的情况下与服务器通信，交换数据，或更新页面")]),t._v(" "),n("p",[t._v("最大的优势：无刷新获取数据。")]),t._v(" "),n("p",[t._v("AJAX 最主要的两个特性做下列事情：")]),t._v(" "),n("ul",[n("li",[t._v("在不重载页面的情况下发送请求给服务器")]),t._v(" "),n("li",[t._v("接受并使用从服务器发来的数据")])]),t._v(" "),n("p",[t._v("AJAX 不是一种新技术，不是新的编程语言，而是一种将现有的（技术）标准组合在一起使用的新方式（方法）")]),t._v(" "),n("p",[t._v("AJAX 的优点")]),t._v(" "),n("ul",[n("li",[t._v("可以无痛刷新页面与服务器进行通信")]),t._v(" "),n("li",[t._v("根据用户事件允许更新部分页面内容")])]),t._v(" "),n("p",[t._v("AJAX 的缺点")]),t._v(" "),n("ul",[n("li",[t._v("没有浏览历史，不能回退")]),t._v(" "),n("li",[t._v("存在跨域问题（同源）")]),t._v(" "),n("li",[t._v("SEO 不友好")])]),t._v(" "),n("h2",{attrs:{id:"step-怎样发送-http-请求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#step-怎样发送-http-请求"}},[t._v("#")]),t._v(" Step：怎样发送 http 请求")]),t._v(" "),n("p",[t._v("XHR（XMLHttpRequest）是 AJAX 的基础,它用于与服务器进行通信")]),t._v(" "),n("p",[t._v("所有的现代浏览器均支持 XHR 对象（IE5 和 IE6 使用 ActiveXObject）")]),t._v(" "),n("ol",[n("li",[t._v("创建 XHR 对象")])]),t._v(" "),n("p",[t._v("为了应对所有现代浏览器，需先检查浏览器是否支持 XHR 对象")]),t._v(" "),n("div",{staticClass:"language-jsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-jsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//创建XHR对象")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("XMLHttpRequest"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  xmlhttp "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  xmlhttp "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ActiveXObject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Microsoft.XMLHTTP"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("XHR 对象向服务器发送请求")])]),t._v(" "),n("div",{staticClass:"language-jsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-jsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//XHR对象向服务器发送请求")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" async"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n *规定请求的类型，URL以及是否异步处理请求\n *1.method:请求的类型：GET或POST\n *2.url:文件在服务器上的位置\n *3.async：true(异步)或false(同步)\n */")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n *将请求发送到服务器\n *string:仅用于POST请求\n */")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n *一、与POST相比，GET更简单也更快，在以下情况使用POST请求：\n *1.更新服务器上的文件或数据库（无法使用缓存文件）。\n *2.向服务器发送大量数据（POST没有数据量限制）。\n *3.发送包含未知字符的用户输入时，POST更稳定可靠。\n *4.如果希望像HTML表单那样POST数据，使用setRequestHeader()来添加HTTP头，然后在send（）方法中规定您希望发送的数据。\n */")]),t._v("\nxmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Content-type"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/x-www-form-urlencoded"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("setRequestHeader")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("header"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n *向请求添加HTTP头\n *1.header:规定头的名称\n *2.value：规定头的值\n */")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n *三、异步-True或False？\n *对于web开发人员来说，发送异步请求是一个巨大的进步，很多在服务器执行的任务相当费时，AJAX出现之前，这可能会引起应用程挂起或停止\n *通过AJAX，JS无需等待服务器的响应，而是：\n *1.在等待服务器响应时执行其他脚本\n *2.当响应就绪后对响应进行处理\n */")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当使用async=true时，请规定在响应处于onreadystatechange事件中的就绪状态时执行的函数")]),t._v("\nxmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myDiv"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nxmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test1.txt"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nxmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//不推荐使用async=false，但对于一些小型的请求也是可以的")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//JS会等到服务器响应就绪才继续执行，如果服务器繁忙或缓慢，应用程序会挂起或停止")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注释：当您使用async=false时，请不要编写onreadystatechange函数-把代码放到send()语句后面即可")]),t._v("\nxmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"GET"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test1.txt"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nxmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ndocument"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myDiv"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("innerHTML "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" xmlhttp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("responseText"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[t._v("服务器响应")])]),t._v(" "),n("div",{staticClass:"language-jsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-jsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如需获得来自服务器的响应，请使用XMLHttpRequest对象的responseText或responseXML属性")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// responseText=>获得字符串形式的响应数据")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// responseXML=>获得XML形式的响应数据")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果来自服务器的响应并非XML，使用responseText属性")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果来自服务器的响应是XML，而且需要作为XML对象进行解析，使用responseXML属性")]),t._v("\n")])])]),n("ol",{attrs:{start:"4"}},[n("li",[t._v("onreadystatechange 事件")])]),t._v(" "),n("div",{staticClass:"language-jsx extra-class"},[n("pre",{pre:!0,attrs:{class:"language-jsx"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当请求被发送到服务器时，我们需要执行一些基于响应的任务")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 每当readyState改变时，就会触发onreadystatechange事件")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// readyState属性存有XMLHttpRequest的状态信息，下面时XHR的三个重要的属性")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// oreadystatechange=>存储函数(或函数名)，每当readyState属性改变时，就会调用该函数")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// readyState=>存有XHR的状态，从0到4发生变化。")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\n *0：请求未初始化\n *1：服务器连接已建立\n *2：请求已接收\n *3：请求处理中\n *4：请求已完成，且响应已就绪\n */")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// status=>200:"OK",404:未找到页面')]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在onreaystatechange事件中，我们规定当服务器响应已做好被处理的准备时所执行的任务")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 当readyState等于4且状态为200时，表示响应已就绪")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// onreadystatechange事件被触发5次(0-4)，对应着readyState的每个变化")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//callback函数=>是一种以参数形式传递给另一个函数的函数")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);